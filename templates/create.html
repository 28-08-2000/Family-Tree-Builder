<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Build Family Tree</title>

{% load static %}
<link rel="stylesheet" type="text/css" href="/static/create_styles.css">

<!-- The family tree JS -->
<script src="/static/familytree.js"></script>
<script type="text/javascript">
 // js code if you want can write here
</script>

</head>
<body>

	<h3>Your Saved Data</h3>

	<table border = "1">
         <tr>
            <td>Row 1, Column 1</td>
            <td>Row 1, Column 1</td>
         </tr>
      </table>

    <table border = "1">

    <div style="width:100%; height:700px;" id="tree"/>


	<!-- let's try prining in an hierarchy -->
	{% for gen in family %}

		<tr>
		<!-- print the members in this generation -->
		{% for ind in gen %}

			<td>	
			<!-- container class -->
			<div id="container">

				<!-- individual card -->
				<div class="card">
					
					<div class = "card_details">
						
						Name: <span class="name">{{ind.name}}</span>
						<br>
						<span>Gender: {{ind.gender}}</span>
						<br> 
						{% if ind.father != None %}
							Father: <span>{{ind.father}}</span>
						{% endif %}
						{% if ind.mother != None %}
							Mother: <span>{{ind.mother}}</span>
						{% endif %}
		
					</div>
				</div>
			</div>

			</td>
		{% endfor %}
		</tr>

	{% endfor %}
	</table>

	<!-- ADD RELATIONSHIP FORM -->
	<div class="form-popup" id="myForm" id="{{ind.id}}">
	  <form action="create/relation/" method="POST" class="form-container">

	    <!-- for the csrf verification required -->
		{% csrf_token %}

		<!-- Fields and button in same div -->
		<div class="from-card">

			{{relationForm.as_p}}

		    <button type="submit" class="btn">relate</button>
		    <button type="button" class="btn cancel" onclick="closeForm()">Close</button>

		</div>
	  </form>
	</div>

	<!-- TO SHOW FORM BUTTON -->	
	<button class="open-button" onclick="openForm()">Add Relation</button>

	<h3> Create your tree here</h3>

	<!-- This form will take user's info -->
	<form action="" method="POST">
		
		<!-- for the csrf verification required -->
		{% csrf_token %}

		<!-- Fields and button in same div -->
		<div class="from-card">

			{{form.as_p}}

			<input type="submit" value="Submit" class="btn btn-secondary">
		</div>

	</form>


<!-- JAVASCRIPT -->

<script>

  var family = new FamilyTree(document.getElementById("tree"), {
      nodeBinding: {
          field_0: "name"
      },

      // MAKE THE FAMILY JSON FILE HERE
      nodes: [
      	{% for gen in family %}
					{% for mem in gen %}
					{ 
						id: {{mem.id}}, 
						
						{% if mem.spouse != None %}
						pids: [{{mem.spouse.id}}],
						{% endif %}
						{% if mem.mother != None %}
						mid: {{mem.mother.id}},
						{% endif %}
						{% if mem.father != None %}
						fid: {{mem.father.id}},
						{% endif %}
						
						name: "{{mem.name}}",
						
						{% if mem.gender == "M" %}
							gender: "male"
						{% endif %}

						{% if mem.gender == "F" %}
							gender: "female"
						{% endif %}
					}, 
					{% endfor %}
				{% endfor %}
      ] 

      // nodes: [
      //     { id: 1, pids: [2], name: "Amber McKenzie", Age: "232938"},
      //     { id: 2, pids: [1], name: "Ava Field" },
      //     { id: 3, mid: 1, fid: 2, name: "Peter Stevens" }  
      // ]

  });
</script> 


<!-- TO SHOW AND HIDE FORM -->
<script>
function openForm() {
  document.getElementById("myForm").style.display = "block";
}

function closeForm() {
  document.getElementById("myForm").style.display = "none";
}
</script>

</body>
</html>